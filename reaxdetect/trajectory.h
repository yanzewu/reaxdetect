// reading trajetory files.

#pragma once

#ifndef TRAJECTORY_H
#define TRAJECTORY_H

#include "simulation.h"

// reader of various trajectory file
class TrajReader {
public:

	struct Config {
		double bondorder_cutoff;
		double bondorder_cutoff_lo;
		int read_atompos;
		Config() : bondorder_cutoff_lo(0.3), bondorder_cutoff(0.5), read_atompos(0) {
		}
	};

	struct atom{
		int id;
		double x, y, z, q;
	};

	struct bond{
		int id_1, id_2;
		int order;
		bond() : order(0) {}
		bond(int a, int b) : id_1(a), id_2(b), order(1) {
		}
	};

	//Data Structure recording information of atoms and bonds
	struct Frame {
		list<atom> atoms;
		list<bond> bonds;
	};	

	vector<int> atomTypes;		//Atom Types List
	vector<double> atomWeights;	//Atom Weights List

	TrajReader() : config() {
	}
	TrajReader(const Config& c) : config(c){
	}

	// open file and read head
	int Open(const string& path);

	//read head
	int ReadTrjHead(Simulation* simulation);

	//read frame. no use directly
	int ReadTrjFrame(Frame&);

	//Read Trajectory File Generated by Lammps, write into GlobalData
	//int ReadTrjFile(const string path, Simulation* globalData, ReaxDetect::Config* const cfg);

private:
	Config config;
	ifstream trjfile;
};
#endif // !TRAJECTORY_H
